---
# Remediate Role Defaults
# Applies scan-driven CAT I remediation to Windows VMs
# Only remediates controls that failed in the scan results

# Target VMs - override with job template variables
target_vms: []
#   - name: vm-name
#     namespace: vm-namespace

# Compliance profile
compliance_profile: "stig"

# For scan-driven mode: List of failed control V-IDs from scan results
# This is populated by the scan role and passed to remediation
# Example: ["V-205711", "V-205713", "V-205919"]
failed_cat1_controls: []

# For EDA-triggered mode: List of failed control V-IDs from alerts
# Example: ["V-205627", "V-205629"]
failed_control_ids: []

# Category for EDA-triggered remediation (CAT1, CAT2, CAT3)
category: ""

# Auto-remediation toggles (set by EDA)
auto_remediate_cat1: false
auto_remediate_cat2: false
auto_remediate_cat3: false

# Controls to skip (by V-ID)
skip_controls: []

# Safety settings
allow_reboot: false
backup_before_change: true
dry_run: false

# Trigger source (for auditing)
trigger_source: "manual"  # manual | eda | scheduled

# External STIG role integration (Windows 2022 only)
# When true, uses infra.windows_ops.windows_manage_stig via win_stig_wrapper
# When false (default), uses existing win2022_stig role
use_external_stig_role: false

# Remediation behavior
remediation:
  max_retries: 3
  retry_delay: 30
  continue_on_error: true
  create_restore_point: true
