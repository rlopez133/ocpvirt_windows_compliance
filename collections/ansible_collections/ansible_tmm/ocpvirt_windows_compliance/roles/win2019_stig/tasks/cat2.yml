---
# Windows Server 2019 STIG - CAT II (Medium Severity) Controls
# When controls_to_remediate is set (EDA-triggered), we still run all controls
# but track what changed for accurate reporting.

# Initialize result tracking for this category
- name: "CAT2 | Initialize remediation tracking"
  ansible.builtin.set_fact:
    cat2_results: "{{ cat2_results | default([]) }}"
  tags:
    - cat2
    - tracking

# WN19-AU-000010 - Audit policy for credential validation
- name: "CAT2 | WN19-AU-000010 | Configure audit policy - Credential Validation"
  when: "'WN19-AU-000010' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Credential Validation
    audit_type: "{{ win19stig_audit_policy.credential_validation }}"
  register: _wn19_au_000010
  tags:
    - cat2
    - WN19-AU-000010

# WN19-AU-000020 - Audit policy for logon events
- name: "CAT2 | WN19-AU-000020 | Configure audit policy - Logon"
  when: "'WN19-AU-000020' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Logon
    audit_type: "{{ win19stig_audit_policy.logon }}"
  register: _wn19_au_000020
  tags:
    - cat2
    - WN19-AU-000020

# WN19-AU-000030 - Audit policy for account management
- name: "CAT2 | WN19-AU-000030 | Configure audit policy - User Account Management"
  when: "'WN19-AU-000030' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: User Account Management
    audit_type: "{{ win19stig_audit_policy.user_account_management }}"
  register: _wn19_au_000030
  tags:
    - cat2
    - WN19-AU-000030

# WN19-AU-000040 - Audit policy for process creation
- name: "CAT2 | WN19-AU-000040 | Configure audit policy - Process Creation"
  when: "'WN19-AU-000040' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Process Creation
    audit_type: "{{ win19stig_audit_policy.process_creation }}"
  register: _wn19_au_000040
  tags:
    - cat2
    - WN19-AU-000040

# WN19-PK-000010 - Minimum password length
- name: "CAT2 | WN19-PK-000010 | Configure minimum password length"
  when: "'WN19-PK-000010' not in win19stig_skip_rules"
  community.windows.win_security_policy:
    section: System Access
    key: MinimumPasswordLength
    value: "{{ win19stig_password_policy.min_length }}"
  register: _wn19_pk_000010
  tags:
    - cat2
    - WN19-PK-000010

# WN19-PK-000020 - Password complexity
- name: "CAT2 | WN19-PK-000020 | Enable password complexity"
  when: "'WN19-PK-000020' not in win19stig_skip_rules"
  community.windows.win_security_policy:
    section: System Access
    key: PasswordComplexity
    value: "{{ 1 if win19stig_password_policy.complexity else 0 }}"
  register: _wn19_pk_000020
  tags:
    - cat2
    - WN19-PK-000020

# WN19-PK-000030 - Maximum password age
- name: "CAT2 | WN19-PK-000030 | Configure maximum password age"
  when: "'WN19-PK-000030' not in win19stig_skip_rules"
  community.windows.win_security_policy:
    section: System Access
    key: MaximumPasswordAge
    value: "{{ win19stig_password_policy.max_age }}"
  register: _wn19_pk_000030
  tags:
    - cat2
    - WN19-PK-000030

# WN19-PK-000040 - Password history
- name: "CAT2 | WN19-PK-000040 | Configure password history"
  when: "'WN19-PK-000040' not in win19stig_skip_rules"
  community.windows.win_security_policy:
    section: System Access
    key: PasswordHistorySize
    value: "{{ win19stig_password_policy.history }}"
  register: _wn19_pk_000040
  tags:
    - cat2
    - WN19-PK-000040

# WN19-SO-000100 - SMB signing required
- name: "CAT2 | WN19-SO-000100 | Enable SMB signing"
  when: "'WN19-SO-000100' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters
    name: RequireSecuritySignature
    data: 1
    type: dword
  register: _wn19_so_000100
  tags:
    - cat2
    - WN19-SO-000100
  notify: restart lanmanserver

# WN19-SO-000110 - SMB client signing
- name: "CAT2 | WN19-SO-000110 | Enable SMB client signing"
  when: "'WN19-SO-000110' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters
    name: RequireSecuritySignature
    data: 1
    type: dword
  register: _wn19_so_000110
  tags:
    - cat2
    - WN19-SO-000110
  notify: restart lanmanworkstation

# WN19-SO-000120 - WDigest authentication
- name: "CAT2 | WN19-SO-000120 | Disable WDigest authentication"
  when: "'WN19-SO-000120' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Control\SecurityProviders\WDigest
    name: UseLogonCredential
    data: 0
    type: dword
  register: _wn19_so_000120
  tags:
    - cat2
    - WN19-SO-000120

# WN19-FW-000010 - Windows Firewall enabled
- name: "CAT2 | WN19-FW-000010 | Enable Windows Firewall - Domain"
  when: "'WN19-FW-000010' not in win19stig_skip_rules"
  community.windows.win_firewall:
    profiles:
      - Domain
    state: enabled
  register: _wn19_fw_000010
  tags:
    - cat2
    - WN19-FW-000010

- name: "CAT2 | WN19-FW-000020 | Enable Windows Firewall - Private"
  when: "'WN19-FW-000020' not in win19stig_skip_rules"
  community.windows.win_firewall:
    profiles:
      - Private
    state: enabled
  register: _wn19_fw_000020
  tags:
    - cat2
    - WN19-FW-000020

- name: "CAT2 | WN19-FW-000030 | Enable Windows Firewall - Public"
  when: "'WN19-FW-000030' not in win19stig_skip_rules"
  community.windows.win_firewall:
    profiles:
      - Public
    state: enabled
  register: _wn19_fw_000030
  tags:
    - cat2
    - WN19-FW-000030

# WN19-EP-000010 - Windows Defender enabled
- name: "CAT2 | WN19-EP-000010 | Enable Windows Defender"
  when: "'WN19-EP-000010' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows Defender
    name: DisableAntiSpyware
    data: 0
    type: dword
  register: _wn19_ep_000010
  tags:
    - cat2
    - WN19-EP-000010

# ============================================================================
# Easy CAT II Controls - Feature 005-easy-stig-remediations
# Low-risk controls safe for automated remediation
# ============================================================================

# --- Audit Policy Controls (Low Risk) ---

# WN19-AU-000050 - Security Group Management
- name: "CAT2 | WN19-AU-000050 | Configure audit policy - Security Group Management"
  when: "'WN19-AU-000050' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Security Group Management
    audit_type: "{{ win19stig_audit_policy.security_group_management }}"
  register: _wn19_au_000050
  tags:
    - cat2
    - WN19-AU-000050

# WN19-AU-000060 - Computer Account Management
- name: "CAT2 | WN19-AU-000060 | Configure audit policy - Computer Account Management"
  when: "'WN19-AU-000060' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Computer Account Management
    audit_type: "{{ win19stig_audit_policy.computer_account_management }}"
  register: _wn19_au_000060
  tags:
    - cat2
    - WN19-AU-000060

# WN19-AU-000070 - Logoff
- name: "CAT2 | WN19-AU-000070 | Configure audit policy - Logoff"
  when: "'WN19-AU-000070' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Logoff
    audit_type: "{{ win19stig_audit_policy.logoff }}"
  register: _wn19_au_000070
  tags:
    - cat2
    - WN19-AU-000070

# WN19-AU-000080 - Special Logon
- name: "CAT2 | WN19-AU-000080 | Configure audit policy - Special Logon"
  when: "'WN19-AU-000080' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Special Logon
    audit_type: "{{ win19stig_audit_policy.special_logon }}"
  register: _wn19_au_000080
  tags:
    - cat2
    - WN19-AU-000080

# WN19-AU-000090 - Removable Storage
- name: "CAT2 | WN19-AU-000090 | Configure audit policy - Removable Storage"
  when: "'WN19-AU-000090' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Removable Storage
    audit_type: "{{ win19stig_audit_policy.removable_storage }}"
  register: _wn19_au_000090
  tags:
    - cat2
    - WN19-AU-000090

# WN19-AU-000100 - Audit Policy Change
- name: "CAT2 | WN19-AU-000100 | Configure audit policy - Audit Policy Change"
  when: "'WN19-AU-000100' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Audit Policy Change
    audit_type: "{{ win19stig_audit_policy.audit_policy_change }}"
  register: _wn19_au_000100
  tags:
    - cat2
    - WN19-AU-000100

# WN19-AU-000110 - Authentication Policy Change
- name: "CAT2 | WN19-AU-000110 | Configure audit policy - Authentication Policy Change"
  when: "'WN19-AU-000110' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Authentication Policy Change
    audit_type: "{{ win19stig_audit_policy.authentication_policy_change }}"
  register: _wn19_au_000110
  tags:
    - cat2
    - WN19-AU-000110

# WN19-AU-000120 - Sensitive Privilege Use
- name: "CAT2 | WN19-AU-000120 | Configure audit policy - Sensitive Privilege Use"
  when: "'WN19-AU-000120' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Sensitive Privilege Use
    audit_type: "{{ win19stig_audit_policy.sensitive_privilege_use }}"
  register: _wn19_au_000120
  tags:
    - cat2
    - WN19-AU-000120

# WN19-AU-000130 - IPsec Driver
- name: "CAT2 | WN19-AU-000130 | Configure audit policy - IPsec Driver"
  when: "'WN19-AU-000130' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: IPsec Driver
    audit_type: "{{ win19stig_audit_policy.ipsec_driver }}"
  register: _wn19_au_000130
  tags:
    - cat2
    - WN19-AU-000130

# WN19-AU-000140 - Security State Change
- name: "CAT2 | WN19-AU-000140 | Configure audit policy - Security State Change"
  when: "'WN19-AU-000140' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: Security State Change
    audit_type: "{{ win19stig_audit_policy.security_state_change }}"
  register: _wn19_au_000140
  tags:
    - cat2
    - WN19-AU-000140

# WN19-AU-000150 - System Integrity
- name: "CAT2 | WN19-AU-000150 | Configure audit policy - System Integrity"
  when: "'WN19-AU-000150' not in win19stig_skip_rules"
  community.windows.win_audit_policy_system:
    subcategory: System Integrity
    audit_type: "{{ win19stig_audit_policy.system_integrity }}"
  register: _wn19_au_000150
  tags:
    - cat2
    - WN19-AU-000150

# --- Registry-Based Security Controls (Low Risk) ---

# WN19-SO-000130 - Disable null session fallback
- name: "CAT2 | WN19-SO-000130 | Disable null session fallback for named pipes"
  when: "'WN19-SO-000130' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Control\Lsa\MSV1_0
    name: AllowNullSessionFallback
    data: 0
    type: dword
  register: _wn19_so_000130
  tags:
    - cat2
    - WN19-SO-000130

# WN19-SO-000140 - Restrict null session shares
- name: "CAT2 | WN19-SO-000140 | Restrict null session access to shares"
  when: "'WN19-SO-000140' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters
    name: RestrictNullSessAccess
    data: 1
    type: dword
  register: _wn19_so_000140
  tags:
    - cat2
    - WN19-SO-000140

# WN19-SO-000150 - Named pipe access restriction
- name: "CAT2 | WN19-SO-000150 | Restrict anonymous access to named pipes"
  when: "'WN19-SO-000150' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters
    name: NullSessionPipes
    data: ""
    type: multistring
  register: _wn19_so_000150
  tags:
    - cat2
    - WN19-SO-000150

# WN19-SO-000160 - Remote registry access restriction
- name: "CAT2 | WN19-SO-000160 | Restrict anonymous access to registry"
  when: "'WN19-SO-000160' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Control\SecurePipeServers\winreg
    name: Description
    data: "Registry Server"
    type: string
  register: _wn19_so_000160
  tags:
    - cat2
    - WN19-SO-000160

# WN19-CC-000080 - Command line in process creation events
- name: "CAT2 | WN19-CC-000080 | Include command line in process creation events"
  when: "'WN19-CC-000080' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Policies\System\Audit
    name: ProcessCreationIncludeCmdLine_Enabled
    data: 1
    type: dword
  register: _wn19_cc_000080
  tags:
    - cat2
    - WN19-CC-000080

# WN19-CC-000090 - PowerShell script block logging
- name: "CAT2 | WN19-CC-000090 | Enable PowerShell script block logging"
  when: "'WN19-CC-000090' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SOFTWARE\Policies\Microsoft\Windows\PowerShell\ScriptBlockLogging
    name: EnableScriptBlockLogging
    data: 1
    type: dword
  register: _wn19_cc_000090
  tags:
    - cat2
    - WN19-CC-000090

# WN19-CC-000100 - Early Launch Antimalware boot-start driver policy
- name: "CAT2 | WN19-CC-000100 | Configure Early Launch Antimalware boot-start driver policy"
  when: "'WN19-CC-000100' not in win19stig_skip_rules"
  ansible.windows.win_regedit:
    path: HKLM:\SYSTEM\CurrentControlSet\Policies\EarlyLaunch
    name: DriverLoadPolicy
    data: 3
    type: dword
  register: _wn19_cc_000100
  tags:
    - cat2
    - WN19-CC-000100

# --- Security Policy Controls (Low Risk) ---

# WN19-PK-000050 - Minimum password age
- name: "CAT2 | WN19-PK-000050 | Configure minimum password age"
  when: "'WN19-PK-000050' not in win19stig_skip_rules"
  community.windows.win_security_policy:
    section: System Access
    key: MinimumPasswordAge
    value: "{{ win19stig_password_policy.min_age }}"
  register: _wn19_pk_000050
  tags:
    - cat2
    - WN19-PK-000050

# WN19-PK-000060 - Reversible encryption disabled
- name: "CAT2 | WN19-PK-000060 | Disable reversible encryption for passwords"
  when: "'WN19-PK-000060' not in win19stig_skip_rules"
  community.windows.win_security_policy:
    section: System Access
    key: ClearTextPassword
    value: "{{ 0 if not win19stig_password_policy.reversible_encryption else 1 }}"
  register: _wn19_pk_000060
  tags:
    - cat2
    - WN19-PK-000060

# ============================================================================
# Aggregate Remediation Results - Feature 005-easy-stig-remediations
# ============================================================================

- name: "CAT2 | Aggregate remediation results"
  ansible.builtin.set_fact:
    cat2_results: >-
      {{
        [
          {'control_id': 'WN19-AU-000010', 'status': 'skipped' if (_wn19_au_000010.skipped | default(false)) else ('failed' if (_wn19_au_000010.failed | default(false)) else ('changed' if (_wn19_au_000010.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000020', 'status': 'skipped' if (_wn19_au_000020.skipped | default(false)) else ('failed' if (_wn19_au_000020.failed | default(false)) else ('changed' if (_wn19_au_000020.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000030', 'status': 'skipped' if (_wn19_au_000030.skipped | default(false)) else ('failed' if (_wn19_au_000030.failed | default(false)) else ('changed' if (_wn19_au_000030.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000040', 'status': 'skipped' if (_wn19_au_000040.skipped | default(false)) else ('failed' if (_wn19_au_000040.failed | default(false)) else ('changed' if (_wn19_au_000040.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000050', 'status': 'skipped' if (_wn19_au_000050.skipped | default(false)) else ('failed' if (_wn19_au_000050.failed | default(false)) else ('changed' if (_wn19_au_000050.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000060', 'status': 'skipped' if (_wn19_au_000060.skipped | default(false)) else ('failed' if (_wn19_au_000060.failed | default(false)) else ('changed' if (_wn19_au_000060.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000070', 'status': 'skipped' if (_wn19_au_000070.skipped | default(false)) else ('failed' if (_wn19_au_000070.failed | default(false)) else ('changed' if (_wn19_au_000070.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000080', 'status': 'skipped' if (_wn19_au_000080.skipped | default(false)) else ('failed' if (_wn19_au_000080.failed | default(false)) else ('changed' if (_wn19_au_000080.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000090', 'status': 'skipped' if (_wn19_au_000090.skipped | default(false)) else ('failed' if (_wn19_au_000090.failed | default(false)) else ('changed' if (_wn19_au_000090.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000100', 'status': 'skipped' if (_wn19_au_000100.skipped | default(false)) else ('failed' if (_wn19_au_000100.failed | default(false)) else ('changed' if (_wn19_au_000100.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000110', 'status': 'skipped' if (_wn19_au_000110.skipped | default(false)) else ('failed' if (_wn19_au_000110.failed | default(false)) else ('changed' if (_wn19_au_000110.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000120', 'status': 'skipped' if (_wn19_au_000120.skipped | default(false)) else ('failed' if (_wn19_au_000120.failed | default(false)) else ('changed' if (_wn19_au_000120.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000130', 'status': 'skipped' if (_wn19_au_000130.skipped | default(false)) else ('failed' if (_wn19_au_000130.failed | default(false)) else ('changed' if (_wn19_au_000130.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000140', 'status': 'skipped' if (_wn19_au_000140.skipped | default(false)) else ('failed' if (_wn19_au_000140.failed | default(false)) else ('changed' if (_wn19_au_000140.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-AU-000150', 'status': 'skipped' if (_wn19_au_000150.skipped | default(false)) else ('failed' if (_wn19_au_000150.failed | default(false)) else ('changed' if (_wn19_au_000150.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-PK-000010', 'status': 'skipped' if (_wn19_pk_000010.skipped | default(false)) else ('failed' if (_wn19_pk_000010.failed | default(false)) else ('changed' if (_wn19_pk_000010.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-PK-000020', 'status': 'skipped' if (_wn19_pk_000020.skipped | default(false)) else ('failed' if (_wn19_pk_000020.failed | default(false)) else ('changed' if (_wn19_pk_000020.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-PK-000030', 'status': 'skipped' if (_wn19_pk_000030.skipped | default(false)) else ('failed' if (_wn19_pk_000030.failed | default(false)) else ('changed' if (_wn19_pk_000030.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-PK-000040', 'status': 'skipped' if (_wn19_pk_000040.skipped | default(false)) else ('failed' if (_wn19_pk_000040.failed | default(false)) else ('changed' if (_wn19_pk_000040.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-PK-000050', 'status': 'skipped' if (_wn19_pk_000050.skipped | default(false)) else ('failed' if (_wn19_pk_000050.failed | default(false)) else ('changed' if (_wn19_pk_000050.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-PK-000060', 'status': 'skipped' if (_wn19_pk_000060.skipped | default(false)) else ('failed' if (_wn19_pk_000060.failed | default(false)) else ('changed' if (_wn19_pk_000060.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-SO-000100', 'status': 'skipped' if (_wn19_so_000100.skipped | default(false)) else ('failed' if (_wn19_so_000100.failed | default(false)) else ('changed' if (_wn19_so_000100.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-SO-000110', 'status': 'skipped' if (_wn19_so_000110.skipped | default(false)) else ('failed' if (_wn19_so_000110.failed | default(false)) else ('changed' if (_wn19_so_000110.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-SO-000120', 'status': 'skipped' if (_wn19_so_000120.skipped | default(false)) else ('failed' if (_wn19_so_000120.failed | default(false)) else ('changed' if (_wn19_so_000120.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-SO-000130', 'status': 'skipped' if (_wn19_so_000130.skipped | default(false)) else ('failed' if (_wn19_so_000130.failed | default(false)) else ('changed' if (_wn19_so_000130.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-SO-000140', 'status': 'skipped' if (_wn19_so_000140.skipped | default(false)) else ('failed' if (_wn19_so_000140.failed | default(false)) else ('changed' if (_wn19_so_000140.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-SO-000150', 'status': 'skipped' if (_wn19_so_000150.skipped | default(false)) else ('failed' if (_wn19_so_000150.failed | default(false)) else ('changed' if (_wn19_so_000150.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-SO-000160', 'status': 'skipped' if (_wn19_so_000160.skipped | default(false)) else ('failed' if (_wn19_so_000160.failed | default(false)) else ('changed' if (_wn19_so_000160.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-FW-000010', 'status': 'skipped' if (_wn19_fw_000010.skipped | default(false)) else ('failed' if (_wn19_fw_000010.failed | default(false)) else ('changed' if (_wn19_fw_000010.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-FW-000020', 'status': 'skipped' if (_wn19_fw_000020.skipped | default(false)) else ('failed' if (_wn19_fw_000020.failed | default(false)) else ('changed' if (_wn19_fw_000020.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-FW-000030', 'status': 'skipped' if (_wn19_fw_000030.skipped | default(false)) else ('failed' if (_wn19_fw_000030.failed | default(false)) else ('changed' if (_wn19_fw_000030.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-EP-000010', 'status': 'skipped' if (_wn19_ep_000010.skipped | default(false)) else ('failed' if (_wn19_ep_000010.failed | default(false)) else ('changed' if (_wn19_ep_000010.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-CC-000080', 'status': 'skipped' if (_wn19_cc_000080.skipped | default(false)) else ('failed' if (_wn19_cc_000080.failed | default(false)) else ('changed' if (_wn19_cc_000080.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-CC-000090', 'status': 'skipped' if (_wn19_cc_000090.skipped | default(false)) else ('failed' if (_wn19_cc_000090.failed | default(false)) else ('changed' if (_wn19_cc_000090.changed | default(false)) else 'ok'))},
          {'control_id': 'WN19-CC-000100', 'status': 'skipped' if (_wn19_cc_000100.skipped | default(false)) else ('failed' if (_wn19_cc_000100.failed | default(false)) else ('changed' if (_wn19_cc_000100.changed | default(false)) else 'ok'))}
        ]
      }}
  tags:
    - cat2
    - tracking
